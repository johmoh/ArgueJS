/** @license MIT (http://opensource.org/licenses/MIT) */
if("function"!=typeof define)var define=require("amdefine")(module);define(function(){"use strict";return function(r){return r()}(function(){function r(r){return"boolean"==typeof r}function t(r){return r instanceof Array}function e(r){return"function"==typeof r}function n(r){return r instanceof Object}function i(r){return e(r)}function o(r){var t,e,n,i=r;if(i)for(t=arguments.length,e=1;t>e;++e)n=arguments[e],i=i.replace(RegExp("\\{"+e+"\\}","g"),n);return i}function a(r,t,e,n){return t===l.TAIL?!0:void 0===r?e===!0:null===r?n===!0:t===l.ANYTYPE?!0:S(r)===t||r instanceof t}function f(r,e,n,i){return e===l.TAIL?t(r):void 0===r?n===!0:null===r?i===!0:e===l.ANYTYPE?!0:S(r)===e||r instanceof e}function c(r,t){return e(t)?r===Function?t:r===l.ANYTYPE?t:t():t}function l(){}var u=!1,s=!1,h=!0,p="bad call: ",d=p+'type of "{1}" is invalid.',m=p+"no arguments. function call is not compatible with function specification.",w=p+"too many arguments. function call is not compatible with function specification.",g=p+"parameter specification #{1} is not an object structure.",v='parameter specification "{1}": ',E=v+"default value is not compatible to parameter type",y=v+'value of "{2}" has incorrect type (must be {3})',b=v+'"{2}" is invalid.',T=v+"type specification is missing.",A=v+"parameter with same name already defined (conflicting position in function specification: #{2})",Y="parameter specification: parameter #{1} has no name",k=v+"specification contains more than one element.",N=v+'"{2}" is {3} allowed for the tail-parameter in a variadic function',O="in a variadic function the tail-parameter must be the last parameter in the function specification.",P=v+"type specification has too many elements.",I=v+'type specification contains unknown option "{2}".',j="Incompatible function call: ",z=j+'mandatory argument "{1}" has no value.',L=j+"too many arguments. {1}",_=function(){var r=Object.prototype.toString.call(arguments);return function(t){return Object.prototype.toString.call(t)===r}}(),S=function(r){return void 0===r?void 0:null===r?null:r.constructor},U=function(){var r=/^[_a-z$]{1}[_a-z0-9$]*$/i;return function(t){return t?r.test(t):!1}}();return l.ANYTYPE=function(){},l.TAIL=function(){},l.getArguments=function(p,v){var j,$,q,x,F,R,V,B,C,D,G,H,J,K,M,Q,W,X,Z,rt,tt;if(1===arguments.length){if(v=arguments[0],!v||v.length>0)throw Error(o(L,"no parameters defined but arguments given"));return{}}if(2!==arguments.length)throw Error(arguments.length<1?m:w);if(!t(p))throw Error(o(d,"_functionSpecification"));if(!_(v)&&!t(v))throw Error(o(d,"_arguments"));for(j=p.length,$={},q={},H=v.length,J=0,K=v[J],M=0;j>M;++M){if(Q=p[M],S(Q)!==Object)throw Error(o(g,M));x=void 0,F=void 0,R=void 0,V=void 0,B=void 0,C=void 0,D=void 0,G=void 0;for(W in Q)if(Q.hasOwnProperty(W)){if(x)throw Error(o(k,x));if(x=W,!U(x))throw Error(o(b,x,"name"));if(X=Q[W],e(X))R=!1,F=X;else if(t(X)){if(X.length<1)throw Error(o(T,x));if(R=!0,F=X[0],X.length>=2){if(X.length>2)throw Error(o(P,x));V=!0,B=X[1]}}else{if(!n(X))throw Error(o(b,x,"type"));for(Z in X)if(X.hasOwnProperty(Z))switch(Z){case"type":if(t(X.type)){if(X.type.length<1)throw Error(o(T,x));if(X.type.length>2)throw Error(o(P,x));R=!0,F=X.type[0]}else R=!1,F=X.type;break;case"defaultValue":V=!0,R=!0,B=X[Z];break;case"allowUndefined":if(C=X[Z],!r(C))throw Error(o(y,x,"allowUndefined","boolean"));break;case"allowNull":if(D=X[Z],!r(D))throw Error(o(y,x,"allowNull","boolean"));break;case"parenthesizeTail":if(G=X[Z],!r(G))throw Error(o(y,x,"parenthesizeTail","boolean"));break;default:throw Error(o(I,x,Z))}}}if(!x)throw Error(o(Y,M));if(q.hasOwnProperty(x))throw Error(o(A,x,M));if(q[x]=!0,!i(F))throw Error(o(b,x,"type"));if(F!==l.TAIL){if(void 0!==G)throw Error(o(N,x,"parenthesizeTail","only"));void 0===C&&(C=s),void 0===D&&(D=u)}else{if(void 0!==C)throw Error(o(N,x,"allowUndefined","not"));if(void 0!==D)throw Error(o(N,x,"allowNull","not"));if(M!==j-1)throw Error(O);void 0===G&&(G=h)}if(H>J&&a(K,F,C,D)){if(F===l.TAIL){if(++J<H){rt=[K];do rt[rt.length]=v[J];while(++J<H);$[x]=rt}else $[x]=!t(K)||G?[K]:K;J=H;break}$[x]=K,++J,H>J&&(K=v[J])}else{if(!R)throw Error(o(z,x));if(V){if(tt=c(F,B),!f(tt,F,C,D))throw Error(o(E,x));$[x]=tt}}}if(H>J)throw Error(o(L,"there are arguments left but all parameters are processed."));return $},l})});