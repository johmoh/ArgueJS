/** @license MIT (http://opensource.org/licenses/MIT) */
if("function"!=typeof define)var define=require("amdefine")(module);define(function(){"use strict";return function(r){return r()}(function(){function r(r){return"boolean"==typeof r}function t(r){return r instanceof Array}function e(r){return"function"==typeof r}function n(r){return r instanceof Object}function i(r){return e(r)}function o(r){var t,e,n,i=r;if(i)for(t=arguments.length,e=1;t>e;++e)n=arguments[e],i=i.replace(RegExp("\\{"+e+"\\}","g"),n);return i}function a(r,e,n,i,o){if(o){if(e===f.TAIL)return t(r);if(void 0===r)return n===!0;if(null===r)return i===!0}else{if(e===f.TAIL)return!0;if(void 0===r)return n===!0;if(null===r)return i===!0}return e===f.ANYTYPE?!0:L(r)===e||r instanceof e}function f(){}var u=!1,c=!1,l=!0,s="bad call: ",h=s+'type of "{1}" is invalid.',p=s+"no arguments. function call is not compatible with function specification.",d=s+"too many arguments. function call is not compatible with function specification.",m=s+"parameter specification #{1} is not an object structure.",w='parameter specification "{1}": ',g=w+"default value is not compatible to parameter type",v=w+'value of "{2}" has incorrect type (must be {3})',E=w+'"{2}" is invalid.',y=w+"type specification is missing.",b=w+"parameter with same name already defined (conflicting position in function specification: #{2})",T="parameter specification: parameter #{1} has no name",A=w+"specification contains more than one element.",k=w+'"{2}" is {3} allowed for the tail-parameter in a variadic function',O="in a variadic function the tail-parameter must be the last parameter in the function specification.",I=w+"type specification has too many elements.",N=w+'type specification contains unknown option "{2}".',P="Incompatible function call: ",Y=P+'mandatory argument "{1}" has no value.',j=P+"too many arguments. {1}",z=function(){var r=Object.prototype.toString.call(arguments);return function(t){return Object.prototype.toString.call(t)===r}}(),L=function(r){return void 0===r?void 0:null===r?null:r.constructor},_=function(){var r=/^[_a-z$]{1}[_a-z0-9$]*$/i;return function(t){return t?r.test(t):!1}}();return f.ANYTYPE=function(){},f.TAIL=function(){},f.getArguments=function(s,w){var P,S,U,$,q,x,F,R,V,B,C,D,G,H,J,K,M,Q,W,X,Z;if(1===arguments.length){if(w=arguments[0],!w||w.length>0)throw Error(o(j,"no parameters defined but arguments given"));return{}}if(2!=arguments.length)throw Error(arguments.length<1?p:d);if(!t(s))throw Error(o(h,"_functionSpecification"));if(!z(w)&&!t(w))throw Error(o(h,"_arguments"));for(P=s.length,S={},U={},D=w.length,G=0,H=w[G],J=0;P>J;++J){if(K=s[J],L(K)!==Object)throw Error(o(m,J));$=void 0,q=void 0,x=void 0,F=void 0,R=void 0,V=void 0,B=void 0,C=void 0;for(M in K)if(K.hasOwnProperty(M)){if($)throw Error(o(A,$));if($=M,!_($))throw Error(o(E,$,"name"));if(Q=K[M],e(Q))x=!1,q=Q;else if(t(Q)){if(Q.length<1)throw Error(o(y,$));if(x=!0,q=Q[0],Q.length>=2){if(Q.length>2)throw Error(o(I,$));F=!0,R=Q[1]}}else{if(!n(Q))throw Error(o(E,$,"type"));for(W in Q)if(Q.hasOwnProperty(W))switch(W){case"type":if(t(Q.type)){if(Q.type.length<1)throw Error(o(y,$));if(Q.type.length>2)throw Error(o(I,$));x=!0,q=Q.type[0]}else x=!1,q=Q.type;break;case"defaultValue":F=!0,x=!0,R=Q[W];break;case"allowUndefined":if(V=Q[W],!r(V))throw Error(o(v,$,"allowUndefined","boolean"));break;case"allowNull":if(B=Q[W],!r(B))throw Error(o(v,$,"allowNull","boolean"));break;case"parenthesizeTail":if(C=Q[W],!r(C))throw Error(o(v,$,"parenthesizeTail","boolean"));break;default:throw Error(o(N,$,W))}}}if(!$)throw Error(o(T,J));if(U.hasOwnProperty($))throw Error(o(b,$,J));if(U[$]=!0,!i(q))throw Error(o(E,$,"type"));if(q!==f.TAIL){if(void 0!==C)throw Error(o(k,$,"parenthesizeTail","only"));void 0===V&&(V=c),void 0===B&&(B=u)}else{if(void 0!==V)throw Error(o(k,$,"allowUndefined","not"));if(void 0!==B)throw Error(o(k,$,"allowNull","not"));if(J!=P-1)throw Error(O);void 0===C&&(C=l)}if(D>G&&a(H,q,V,B,!1)){if(q===f.TAIL){if(++G<D){X=[H];do X[X.length]=w[G];while(++G<D);S[$]=X}else S[$]=!t(H)||C?[H]:H;G=D;break}S[$]=H,++G,D>G&&(H=w[G])}else{if(!x)throw Error(o(Y,$));if(F){if(Z=q!==Function&&q!==f.ANYTYPE&&e(R)?R():R,!a(Z,q,V,B,!0))throw Error(o(g,$));S[$]=Z}}}if(D>G)throw Error(o(j,"there are arguments left but all parameters are processed."));return S},f})});