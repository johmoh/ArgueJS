/** @license MIT (http://opensource.org/licenses/MIT) */
if("function"!=typeof define)var define=require("amdefine")(module);define(function(){"use strict";return function(r){return r()}(function(){function r(r){return"boolean"==typeof r}function t(r){return r instanceof Array}function e(r){return"function"==typeof r}function n(r){return r instanceof Object}function i(r){return e(r)}function o(r){var t,e,n,i=r;if(i)for(t=arguments.length,e=1;t>e;++e)n=arguments[e],i=i.replace(RegExp("\\{"+e+"\\}","g"),n);return i}function a(r,t,e,n){return t===c.TAIL?!0:void 0===r?e===!0:null===r?n===!0:t===c.ANYTYPE?!0:_(r)===t||r instanceof t}function f(r,e,n,i){return e===c.TAIL?t(r):void 0===r?n===!0:null===r?i===!0:e===c.ANYTYPE?!0:_(r)===e||r instanceof e}function c(){}var l=!1,u=!1,s=!0,h="bad call: ",p=h+'type of "{1}" is invalid.',d=h+"no arguments. function call is not compatible with function specification.",m=h+"too many arguments. function call is not compatible with function specification.",w=h+"parameter specification #{1} is not an object structure.",g='parameter specification "{1}": ',v=g+"default value is not compatible to parameter type",E=g+'value of "{2}" has incorrect type (must be {3})',y=g+'"{2}" is invalid.',b=g+"type specification is missing.",T=g+"parameter with same name already defined (conflicting position in function specification: #{2})",A="parameter specification: parameter #{1} has no name",Y=g+"specification contains more than one element.",k=g+'"{2}" is {3} allowed for the tail-parameter in a variadic function',N="in a variadic function the tail-parameter must be the last parameter in the function specification.",O=g+"type specification has too many elements.",P=g+'type specification contains unknown option "{2}".',I="Incompatible function call: ",j=I+'mandatory argument "{1}" has no value.',z=I+"too many arguments. {1}",L=function(){var r=Object.prototype.toString.call(arguments);return function(t){return Object.prototype.toString.call(t)===r}}(),_=function(r){return void 0===r?void 0:null===r?null:r.constructor},S=function(){var r=/^[_a-z$]{1}[_a-z0-9$]*$/i;return function(t){return t?r.test(t):!1}}();return c.ANYTYPE=function(){},c.TAIL=function(){},c.getArguments=function(h,g){var I,U,$,q,x,F,R,V,B,C,D,G,H,J,K,M,Q,W,X,Z,rt;if(1===arguments.length){if(g=arguments[0],!g||g.length>0)throw Error(o(z,"no parameters defined but arguments given"));return{}}if(2!==arguments.length)throw Error(arguments.length<1?d:m);if(!t(h))throw Error(o(p,"_functionSpecification"));if(!L(g)&&!t(g))throw Error(o(p,"_arguments"));for(I=h.length,U={},$={},G=g.length,H=0,J=g[H],K=0;I>K;++K){if(M=h[K],_(M)!==Object)throw Error(o(w,K));q=void 0,x=void 0,F=void 0,R=void 0,V=void 0,B=void 0,C=void 0,D=void 0;for(Q in M)if(M.hasOwnProperty(Q)){if(q)throw Error(o(Y,q));if(q=Q,!S(q))throw Error(o(y,q,"name"));if(W=M[Q],e(W))F=!1,x=W;else if(t(W)){if(W.length<1)throw Error(o(b,q));if(F=!0,x=W[0],W.length>=2){if(W.length>2)throw Error(o(O,q));R=!0,V=W[1]}}else{if(!n(W))throw Error(o(y,q,"type"));for(X in W)if(W.hasOwnProperty(X))switch(X){case"type":if(t(W.type)){if(W.type.length<1)throw Error(o(b,q));if(W.type.length>2)throw Error(o(O,q));F=!0,x=W.type[0]}else F=!1,x=W.type;break;case"defaultValue":R=!0,F=!0,V=W[X];break;case"allowUndefined":if(B=W[X],!r(B))throw Error(o(E,q,"allowUndefined","boolean"));break;case"allowNull":if(C=W[X],!r(C))throw Error(o(E,q,"allowNull","boolean"));break;case"parenthesizeTail":if(D=W[X],!r(D))throw Error(o(E,q,"parenthesizeTail","boolean"));break;default:throw Error(o(P,q,X))}}}if(!q)throw Error(o(A,K));if($.hasOwnProperty(q))throw Error(o(T,q,K));if($[q]=!0,!i(x))throw Error(o(y,q,"type"));if(x!==c.TAIL){if(void 0!==D)throw Error(o(k,q,"parenthesizeTail","only"));void 0===B&&(B=u),void 0===C&&(C=l)}else{if(void 0!==B)throw Error(o(k,q,"allowUndefined","not"));if(void 0!==C)throw Error(o(k,q,"allowNull","not"));if(K!==I-1)throw Error(N);void 0===D&&(D=s)}if(G>H&&a(J,x,B,C)){if(x===c.TAIL){if(++H<G){Z=[J];do Z[Z.length]=g[H];while(++H<G);U[q]=Z}else U[q]=!t(J)||D?[J]:J;H=G;break}U[q]=J,++H,G>H&&(J=g[H])}else{if(!F)throw Error(o(j,q));if(R){if(rt=x!==Function&&x!==c.ANYTYPE&&e(V)?V():V,!f(rt,x,B,C))throw Error(o(v,q));U[q]=rt}}}if(G>H)throw Error(o(z,"there are arguments left but all parameters are processed."));return U},c})});